{% extends 'base.html.twig' %}

{% block body %}
    
    <h1>Transactions list</h1>
    <div class="form-group">
        <div class="input-group">
            <select type="text" class="form-control" id="monthFilter">
                <option value=''>--Select Month--</option>
                <option value='1'>Janaury</option>
                <option value='2'>February</option>
                <option value='3'>March</option>
                <option value='4'>April</option>
                <option value='5'>May</option>
                <option value='6'>June</option>
                <option value='7'>July</option>
                <option value='8'>August</option>
                <option value='9'>September</option>
                <option value='10'>October</option>
                <option value='11'>November</option>
                <option value='12'>December</option>
            </select>
        </div>
    </div>
    <div class="table-responsive">
        <table class="table table-striped table-sm">
            <thead>
            <tr>
                <th>Title</th>
                <th>Amount</th>
                <th>Is input</th>
                <th>Description</th>
                <th>Is valid</th>
                <th>Category</th>
                <th>Tags</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody id="transactionsContainer">
            
            </tbody>
        </table>
    </div>
{% endblock %}

{% block javascripts %}
    <script>
        var Screen2 = {
            init: function () {
                this.$monthFilter = "#monthFilter";
                this.$transactionsContainer = "#transactionsContainer"
                this.bindMonthChange();
            },
            bindMonthChange: function () {
                that = this;
                $(this.$monthFilter).on('change', function (event) {
                    that.showLoader();
                    that.getAndRenderTransaction($(this).val());
                })
            },
            getAndRenderTransaction: function ($month) {
                $.get("{{ path('api_index') }}", {
                    'month': $month,
                }, function (html) {
                    $(Screen2.$transactionsContainer).html(html);
                }).always(function () {
                    Screen2.closeLoader();
                });

            },
            showLoader: function () {
                $("#loadMe").modal({
                    backdrop: "static",
                    keyboard: false,
                    show: true
                });
            },
            closeLoader: function () {
                setTimeout(function () {
                    $("#loadMe").modal("hide");
                }, 1000);
            }
        };
        Screen2.init();
    
    </script>
{% endblock %}
